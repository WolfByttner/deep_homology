{'colour_mode': 'rgb', 'data_path': 'h5images_short/resampled_16x16_directions_32_histnorm', 'epochs': 100, 'momentum': 0.9, 'lr_start': 0.0005, 'lr_ep_step': 5, 'lr_adaption': 0.5, 'test_ratio': 0.1, 'batch_size': 8, 'directions': 32, 'resampled_size': (16, 16), 'sat_key': '100_epoch_lr_00005_quick_lr_2_convs_dense_linear_one_layer_AdaptiveMaxPool32_shore', 'cuda': False}
Data setup...
Loading providers
Merging providers
Create data loader...
Creating network
['dim_0_dir_0_red', 'dim_0_dir_1_red', 'dim_0_dir_10_red', 'dim_0_dir_11_red', 'dim_0_dir_12_red', 'dim_0_dir_13_red', 'dim_0_dir_14_red', 'dim_0_dir_15_red', 'dim_0_dir_16_red', 'dim_0_dir_17_red', 'dim_0_dir_18_red', 'dim_0_dir_19_red', 'dim_0_dir_2_red', 'dim_0_dir_20_red', 'dim_0_dir_21_red', 'dim_0_dir_22_red', 'dim_0_dir_23_red', 'dim_0_dir_24_red', 'dim_0_dir_25_red', 'dim_0_dir_26_red', 'dim_0_dir_27_red', 'dim_0_dir_28_red', 'dim_0_dir_29_red', 'dim_0_dir_3_red', 'dim_0_dir_30_red', 'dim_0_dir_31_red', 'dim_0_dir_4_red', 'dim_0_dir_5_red', 'dim_0_dir_6_red', 'dim_0_dir_7_red', 'dim_0_dir_8_red', 'dim_0_dir_9_red', 'dim_0_dir_0_green', 'dim_0_dir_1_green', 'dim_0_dir_10_green', 'dim_0_dir_11_green', 'dim_0_dir_12_green', 'dim_0_dir_13_green', 'dim_0_dir_14_green', 'dim_0_dir_15_green', 'dim_0_dir_16_green', 'dim_0_dir_17_green', 'dim_0_dir_18_green', 'dim_0_dir_19_green', 'dim_0_dir_2_green', 'dim_0_dir_20_green', 'dim_0_dir_21_green', 'dim_0_dir_22_green', 'dim_0_dir_23_green', 'dim_0_dir_24_green', 'dim_0_dir_25_green', 'dim_0_dir_26_green', 'dim_0_dir_27_green', 'dim_0_dir_28_green', 'dim_0_dir_29_green', 'dim_0_dir_3_green', 'dim_0_dir_30_green', 'dim_0_dir_31_green', 'dim_0_dir_4_green', 'dim_0_dir_5_green', 'dim_0_dir_6_green', 'dim_0_dir_7_green', 'dim_0_dir_8_green', 'dim_0_dir_9_green', 'dim_0_dir_0_blue', 'dim_0_dir_1_blue', 'dim_0_dir_10_blue', 'dim_0_dir_11_blue', 'dim_0_dir_12_blue', 'dim_0_dir_13_blue', 'dim_0_dir_14_blue', 'dim_0_dir_15_blue', 'dim_0_dir_16_blue', 'dim_0_dir_17_blue', 'dim_0_dir_18_blue', 'dim_0_dir_19_blue', 'dim_0_dir_2_blue', 'dim_0_dir_20_blue', 'dim_0_dir_21_blue', 'dim_0_dir_22_blue', 'dim_0_dir_23_blue', 'dim_0_dir_24_blue', 'dim_0_dir_25_blue', 'dim_0_dir_26_blue', 'dim_0_dir_27_blue', 'dim_0_dir_28_blue', 'dim_0_dir_29_blue', 'dim_0_dir_3_blue', 'dim_0_dir_30_blue', 'dim_0_dir_31_blue', 'dim_0_dir_4_blue', 'dim_0_dir_5_blue', 'dim_0_dir_6_blue', 'dim_0_dir_7_blue', 'dim_0_dir_8_blue', 'dim_0_dir_9_blue']
Creating trainer
Running training
                                                  Epoch 1/100 Batch 1/9 (11.11 %)                                                  Epoch 1/100 Batch 2/9 (22.22 %)                                                  Epoch 1/100 Batch 3/9 (33.33 %)                                                  Epoch 1/100 Batch 4/9 (44.44 %)                                                  Epoch 1/100 Batch 5/9 (55.56 %)                                                  Epoch 1/100 Batch 6/9 (66.67 %)                                                  Epoch 1/100 Batch 7/9 (77.78 %)                                                  Epoch 1/100 Batch 8/9 (88.89 %)                                                  Epoch 1/100 Batch 9/9 (100.00 %)
testing... tensor([[ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        ...,
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876]])
tensor([[ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        ...,
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876]])
tensor([[ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        ...,
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876]])
tensor([[ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        ...,
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876]])
tensor([[ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        ...,
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176,  ..., -0.0295,  0.0257,  0.0876]])
tensor([[ 0.0128,  0.0213,  0.1176, -0.0043,  0.0204,  0.0153, -0.0837, -0.0520,
          0.0254,  0.0025,  0.0567, -0.0364, -0.0175, -0.0399,  0.0731,  0.0016,
         -0.0421, -0.0577,  0.0407, -0.0304,  0.0010,  0.0198,  0.0621, -0.0623,
          0.0435, -0.0383,  0.0291, -0.0730, -0.0360, -0.0618, -0.0571, -0.0224,
         -0.0123, -0.0094, -0.0695,  0.0364, -0.0345,  0.0078,  0.0242,  0.0312,
         -0.0291,  0.0590, -0.0343,  0.0143, -0.0225, -0.0216,  0.0728, -0.0383,
          0.0149,  0.0083, -0.0390,  0.0464,  0.0266,  0.0260,  0.0326,  0.0009,
          0.0076,  0.0553,  0.0293, -0.0581, -0.0050, -0.0299, -0.0673,  0.0776,
         -0.0309,  0.0349, -0.0799, -0.0456,  0.0537,  0.0685,  0.0184,  0.0462,
         -0.0508,  0.0538, -0.0021, -0.0394,  0.0382,  0.0104,  0.0233, -0.0893,
         -0.0427,  0.0276, -0.0151, -0.0189,  0.0544,  0.0558,  0.0009,  0.0689,
          0.0216, -0.0150, -0.0519, -0.0421, -0.0405, -0.0179,  0.0282,  0.0270,
          0.0226, -0.0011,  0.0089,  0.0543,  0.0499, -0.0506, -0.0308, -0.0023,
          0.0455,  0.0224, -0.0256, -0.0381,  0.0056, -0.0109,  0.0762,  0.1082,
          0.0056,  0.0154, -0.0292,  0.0100,  0.0809, -0.0576,  0.0448, -0.0545,
          0.0421,  0.0855, -0.0274,  0.0055, -0.0303,  0.0682,  0.0190, -0.0593,
          0.0714, -0.0869, -0.0179, -0.0368,  0.0237, -0.0168,  0.0301, -0.0611,
         -0.0324, -0.0091,  0.0481, -0.0208,  0.0324, -0.0337,  0.0244, -0.0101,
         -0.0163,  0.0084, -0.0216,  0.0131, -0.0380, -0.0758,  0.0640, -0.0846,
         -0.0401, -0.0526,  0.0422, -0.0648,  0.0251, -0.0172,  0.0242,  0.0281,
         -0.0107,  0.0388,  0.0312,  0.0386,  0.0603, -0.0174, -0.0370,  0.0264,
         -0.0817, -0.0765, -0.0329,  0.0144, -0.0119,  0.0272, -0.0188,  0.0321,
          0.0380,  0.0312, -0.0055, -0.0102, -0.0312,  0.0043,  0.0078,  0.0468,
          0.0055,  0.0285,  0.0005, -0.0197, -0.0486, -0.0312, -0.0328,  0.0504,
          0.0416,  0.0487,  0.0011, -0.0351,  0.0723, -0.0295,  0.0257,  0.0876],
        [ 0.0128,  0.0213,  0.1176, -0.0043,  0.0204,  0.0153, -0.0837, -0.0520,
          0.0254,  0.0025,  0.0567, -0.0364, -0.0175, -0.0399,  0.0731,  0.0016,
         -0.0421, -0.0577,  0.0407, -0.0304,  0.0010,  0.0198,  0.0621, -0.0623,
          0.0435, -0.0383,  0.0291, -0.0730, -0.0360, -0.0618, -0.0571, -0.0224,
         -0.0123, -0.0094, -0.0695,  0.0364, -0.0345,  0.0078,  0.0242,  0.0312,
         -0.0291,  0.0590, -0.0343,  0.0143, -0.0225, -0.0216,  0.0728, -0.0383,
          0.0149,  0.0083, -0.0390,  0.0464,  0.0266,  0.0260,  0.0326,  0.0009,
          0.0076,  0.0553,  0.0293, -0.0581, -0.0050, -0.0299, -0.0673,  0.0776,
         -0.0309,  0.0349, -0.0799, -0.0456,  0.0537,  0.0685,  0.0184,  0.0462,
         -0.0508,  0.0538, -0.0021, -0.0394,  0.0382,  0.0104,  0.0233, -0.0893,
         -0.0427,  0.0276, -0.0151, -0.0189,  0.0544,  0.0558,  0.0009,  0.0689,
          0.0216, -0.0150, -0.0519, -0.0421, -0.0405, -0.0179,  0.0282,  0.0270,
          0.0226, -0.0011,  0.0089,  0.0543,  0.0499, -0.0506, -0.0308, -0.0023,
          0.0455,  0.0224, -0.0256, -0.0381,  0.0056, -0.0109,  0.0762,  0.1082,
          0.0056,  0.0154, -0.0292,  0.0100,  0.0809, -0.0576,  0.0448, -0.0545,
          0.0421,  0.0855, -0.0274,  0.0055, -0.0303,  0.0682,  0.0190, -0.0593,
          0.0714, -0.0869, -0.0179, -0.0368,  0.0237, -0.0168,  0.0301, -0.0611,
         -0.0324, -0.0091,  0.0481, -0.0208,  0.0324, -0.0337,  0.0244, -0.0101,
         -0.0163,  0.0084, -0.0216,  0.0131, -0.0380, -0.0758,  0.0640, -0.0846,
         -0.0401, -0.0526,  0.0422, -0.0648,  0.0251, -0.0172,  0.0242,  0.0281,
         -0.0107,  0.0388,  0.0312,  0.0386,  0.0603, -0.0174, -0.0370,  0.0264,
         -0.0817, -0.0765, -0.0329,  0.0144, -0.0119,  0.0272, -0.0188,  0.0321,
          0.0380,  0.0312, -0.0055, -0.0102, -0.0312,  0.0043,  0.0078,  0.0468,
          0.0055,  0.0285,  0.0005, -0.0197, -0.0486, -0.0312, -0.0328,  0.0504,
          0.0416,  0.0487,  0.0011, -0.0351,  0.0723, -0.0295,  0.0257,  0.0876]])
Traceback (most recent call last):
  File "slayer_network_rgb.py", line 432, in <module>
    mean = train_network(params)
  File "slayer_network_rgb.py", line 397, in train_network
    trainer.run()
  File "/home/amahon/research/deep_homology/chofer_nips2017/chofer_torchex/chofer_torchex/utils/trainer/trainer.py", line 93, in run
    self.events.post_epoch(self._get_default_event_kwargs(), trainer=self)
  File "/home/amahon/research/deep_homology/chofer_nips2017/chofer_torchex/chofer_torchex/utils/trainer/trainer.py", line 18, in __call__
    callback(**kwargs)
  File "/home/amahon/research/deep_homology/chofer_nips2017/chofer_torchex/chofer_torchex/utils/trainer/plugins/scores.py", line 63, in post_epoch_handler
    labels=self._test_data.dataset.labels)
  File "/home/amahon/.local/lib/python3.7/site-packages/sklearn/metrics/classification.py", line 1813, in log_loss
    'labels: {0}'.format(lb.classes_))
ValueError: The number of classes in labels is different from that in y_pred. Classes found in labels: ['1' '10' '100' '101' '102' '103' '104' '105' '106' '107' '108' '109' '11'
 '110' '111' '112' '113' '114' '115' '116' '117' '118' '119' '12' '120'
 '121' '122' '123' '124' '125' '126' '127' '128' '129' '13' '130' '131'
 '132' '133' '134' '135' '136' '137' '138' '139' '14' '140' '141' '142'
 '143' '144' '145' '146' '147' '148' '149' '15' '150' '151' '152' '153'
 '154' '155' '156' '157' '158' '159' '16' '160' '161' '162' '163' '164'
 '165' '166' '167' '168' '169' '17' '170' '171' '172' '173' '174' '175'
 '176' '177' '178' '179' '18' '180' '181' '182' '183' '184' '185' '186'
 '187' '188' '189' '19' '190' '191' '192' '193' '194' '195' '196' '197'
 '198' '199' '2' '20' '200' '21' '22' '23' '24' '25' '26' '27' '28' '29'
 '3' '30' '31' '32' '33' '34' '35' '36' '37' '38' '39' '4' '40' '41' '42'
 '43' '44' '45' '46' '47' '48' '49' '5' '50' '51' '52' '53' '54' '55' '56'
 '57' '58' '59' '6' '60' '61' '62' '63' '64' '65' '66' '67' '68' '69' '7'
 '70' '71' '72' '73' '74' '75' '76' '77' '78' '79' '8' '80' '81' '82' '83'
 '84' '85' '86' '87' '88' '89' '9' '90' '91' '92' '93' '94' '95' '96' '97'
 '98' '99']
